> 这算是本人闲暇时间根据自身公司情况所开发的一个插件，简单来说就是为了方便部署以及通知到对应的对应测试人员。简单来说，本功能就是把编译的内容通过FTP上传到服务器，然后在通过企业微信或者钉钉发送相关的版本信息并且@测试人员。如果是有大大借助gitlab钩子实现自动更新的话，看看热闹就好，主要还是针对手动部署以及一个流程化的部署。

### 一、private-self-service 功能简介
[private-self-service](https://www.npmjs.com/package/private-self-service)插件的主要功能是根据一份自身情况的配置文件，通过gulp走一个工作流，实现一个自动部署ftp功能。早期我其实是定制化了一个流程，但是发现往下推的时候，因为这一整个流程会显得有些繁琐有些项目就不是很适配了，所以我特地把功能抽离成模块，然后再通过gulp自己配置想要的功能，这样流程完全自定义。但是总的流程就只是通过ftp自动部署ftp，然后再通过企业微信或者钉钉发送对应的版本信息以及更新人的信息。

### 二、config 配置文件
插件是共有模块，但是配置文件是根据自身情况配置的，这个取决于自己，想要什么功能，就配置什么信息。我这里会根据一个个模块来展示对应配置文件的功能，因为这个插件读取的信息就是来源这一份配置文件。

config文件功能大体分五部分
```
{
  "project": {
  	// 项目信息部分
  },
  "serverFiles": {
  	// 服务器信息部分
  },
  "gitSetUp": {
  	// git信息部分
  },
  "tapdInfo": {
  	// 测试信息部分
  },
  "dingTalk": {
  	// 企业微信信息部分
  }
}
```
1. project 项目信息，因为这里存在多个项目就多个配置文件的问题，所以我把配置信息组合成一份文件，项目配置对应多个项目，因为大部分项目配置信息是一致的，只是个别会不同而已。为了方便统一调整和修改，所以特地把这部分放在一起
```
"project": { // 总体项目信息
    "xxx": { // 项目标识，这个就表示一整个项目的完整信息
      "base": {
        "name": "", // 项目名称
        "dist": "", // 项目输出目录
        "remote": "/root/html/jsxqyg-h5", // 远端目录
        "remoteWidthList": [], // 白名单 有时候更新项目，会是全量，但是会有部分文件因为太大也不需要更新，所以我这里加了白名单
        "getCopyFile": [], // 复制上传文件目录 小部分情况下，前端会输出多个目录。更新也需要多个目录，以nuxt为例，会产生多个文件内容需要更新，所以我这里提供了非覆盖式聚合文件更新的方式 
        "isGetFiles": false, // 是否复制文件
        "isUpdateFile": true, // 是否更新文件
        "coverUpData": false, // 是否覆盖文件
        "isInquirer": false // 是否启用更新询问
      },
      "serverFiles": { // 当前项目内服务器信息 因为可能会存在不同项目更新不同的服务器
      	"host": "", // ip地址
        "port": "", // 端口
        "username": "", // ftp账号
        "password": "" // ftp密码
      }
    }
  }
```

2. serverFiles 服务器信息，这部分信息主要是读取，更新服务器的ip地址以及端口，还有ftp的账号信息。
```
"serverFiles": { // 所有项目服务器信息，因为存在多个项目，这部分信息主要是建立在所有项目都是在同一个服务器更新，如果不是请针对项目内配置。
  "host": "", // ip地址
  "port": "", // 端口
  "username": "", // ftp账号
  "password": "" // ftp密码
},
```

3. gitSetUp git信息，这部分信息主要是读取，当前项目以及版本信息，因为我这边会根据分支信息读取到当前项目的版本，不过这个需要一个规范的配置。简单点的话，我就边就是获取到一个更新人信息，因为多人协作开发的时候，会存在一个并行版本的问题，正常情况是合并分支然后再统一部署，这里为了避免都在更新项目，所以这里会有一个更新成功的推送消息的订阅，
```
"gitSetUp": {
  "devList": {
  }
}
```